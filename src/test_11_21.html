<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome | HAL未来創造展</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Space+Grotesk:wght@300;500;700&family=Noto+Sans+JP:wght@900&display=swap" rel="stylesheet">
    
    <style>
        /* --- 基础设定 --- */
        :root {
            --bg-color: #fce412; 
            --text-color: #1a1a1a;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Space Grotesk', sans-serif;
            overflow: hidden;
            margin: 0;
            /* 默认显示光标，JS 检测非触摸设备后再隐藏 */
            cursor: auto; 
            height: 100vh;
            width: 100vw;
        }

        /* 仅在支持 hover 的设备(鼠标)上隐藏系统光标 */
        @media (hover: hover) {
            body { cursor: none; }
        }

        /* =========================================
           1. 加载层
           ========================================= */
        #loader-wrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 50; pointer-events: none;
        }

        .loader-panel {
            position: absolute; top: 0; width: 50%; height: 100%;
            background: #000; z-index: 2;
            will-change: transform; /* 性能优化 hint */
            transition: transform 1s cubic-bezier(0.8, 0, 0.2, 1);
        }
        
        .panel-left { left: 0; border-right: 1px solid rgba(255,255,255,0.1); }
        .panel-right { right: 0; border-left: 1px solid rgba(255,255,255,0.1); }

        .loading-line-wrap {
            position: absolute; top: 0; left: 50%;
            transform: translateX(-50%);
            width: 4px; height: 100%;
            z-index: 3;
            display: flex; align-items: center; justify-content: center;
        }

        #v-bar {
            width: 100%; height: 100%; /* 占满父容器 */
            background-color: var(--bg-color);
            box-shadow: 0 0 20px var(--bg-color);
            transition: opacity 0.5s;
            /* 核心优化: 使用 scaleY 代替 height 动画，性能更好 */
            transform: scaleY(0); 
            transform-origin: center;
        }

        .loader-counter {
            position: absolute; top: 50%; left: calc(50% + 20px);
            transform: translateY(-50%);
            font-family: 'Oswald', sans-serif; font-size: 2rem; font-weight: bold;
            color: var(--bg-color); z-index: 3; transition: opacity 0.3s;
            font-variant-numeric: tabular-nums; /* 防止数字变化时抖动 */
        }

        .split-open .panel-left { transform: translateX(-100%); }
        .split-open .panel-right { transform: translateX(100%); }
        .fade-out { opacity: 0; }

        /* =========================================
           2. 跑马灯 (Marquee) - 优化版
           ========================================= */
        .marquee-container {
            position: absolute; top: 50%; left: 0; width: 100%;
            transform: translateY(-50%) rotate(-5deg); 
            z-index: 0; opacity: 0.08; pointer-events: none; 
            white-space: nowrap; overflow: hidden;
            display: flex; /* 使用 Flex 布局 */
        }

        .marquee-content {
            flex-shrink: 0; /* 防止被压缩 */
            font-family: 'Oswald', 'Noto Sans JP', sans-serif;
            font-weight: 900; 
            font-size: 15vh; 
            text-transform: uppercase;
            padding-right: 2rem; /* 间距 */
            animation: scrollText 25s linear infinite;
            will-change: transform;
        }

        /* 移动端优化：不隐藏，而是缩小 */
        @media (max-width: 768px) {
            .marquee-content {
                font-size: 8vh; /* 字体变小 */
                animation-duration: 15s; /* 速度调整 */
            }
            .marquee-container {
                opacity: 0.05; /* 更淡一点以免干扰 */
            }
        }

        @keyframes scrollText {
            from { transform: translateX(0); }
            to { transform: translateX(-100%); }
        }

        /* =========================================
           3. 主内容区
           ========================================= */
        #hero {
            position: relative; z-index: 10; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            opacity: 0; transform: scale(0.95);
            transition: opacity 1s ease-out, transform 1s ease-out;
        }
        .brand-logo {
            width: 300px; max-width: 60vw; mix-blend-mode: multiply; 
            filter: blur(10px); transform: translateY(20px);
            transition: all 1.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .logo-reveal { filter: blur(0px) !important; transform: translateY(0) !important; }
        
        .hero-text {
            margin-top: 2rem; text-transform: uppercase; letter-spacing: 0.2em;
            font-size: 0.8rem; opacity: 0; transform: translateY(20px);
            transition: opacity 0.8s ease 0.5s, transform 0.8s ease 0.5s;
        }
        .hero-text.show { opacity: 1; transform: translateY(0); }
        
        .enter-btn {
            margin-top: 3rem; padding: 12px 32px; border: 2px solid black;
            background: transparent; text-transform: uppercase; font-weight: bold;
            font-size: 0.9rem; position: relative; overflow: hidden;
            transition: color 0.3s; opacity: 0; animation: fadeInUp 1s forwards 1.2s;
            /* 仅在有自定义光标时隐藏系统光标 */
            cursor: inherit; 
        }
        .enter-btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: black; transition: left 0.4s cubic-bezier(0.23, 1, 0.32, 1); z-index: -1;
        }
        .enter-btn:hover { color: var(--bg-color); }
        .enter-btn:hover::before { left: 0; }
        @keyframes fadeInUp { to { opacity: 1; } }

        /* =========================================
           4. 自定义光标 (仅限桌面端)
           ========================================= */
        .cursor-dot, .cursor-outline {
            display: none; /* 默认隐藏 */
            pointer-events: none; position: fixed; 
            transform: translate(-50%, -50%); z-index: 999;
        }
        .cursor-dot { width: 10px; height: 10px; background: black; border-radius: 50%; }
        .cursor-outline { width: 40px; height: 40px; border: 1px solid black; border-radius: 50%; transition: width 0.2s, height 0.2s; }
        
        /* 只在支持 hover 的设备显示自定义光标 */
        @media (hover: hover) {
            .cursor-dot, .cursor-outline { display: block; }
            body.hover-active .cursor-outline {
                width: 60px; height: 60px; background: rgba(0,0,0,0.1); border-color: transparent;
            }
        }

        .grid-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 50px 50px; z-index: -1; pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="loader-wrapper">
        <div id="panel-left" class="loader-panel panel-left"></div>
        <div id="panel-right" class="loader-panel panel-right"></div>
        <div class="loading-line-wrap">
            <div id="v-bar"></div>
        </div>
        <div class="loader-counter">0%</div>
    </div>

    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>
    <div class="grid-bg"></div>

    <div class="marquee-container" aria-hidden="true">
        <div class="marquee-content">
            HAL FUTURE CREATION EXHIBITION 2025 // DESIGN // DEVELOPMENT // INNOVATION // 
        </div>
        <div class="marquee-content">
            HAL FUTURE CREATION EXHIBITION 2025 // DESIGN // DEVELOPMENT // INNOVATION // 
        </div>
    </div>

    <div id="hero">
        <div class="magnetic-wrap" id="magnetic-area">
            <img src="./assets/icons/vib_black.png" alt="VIB Logo" class="brand-logo" id="main-logo" 
                 onerror="this.src='https://placehold.co/400x200/black/white?text=VIB+LOGO';this.style.mixBlendMode='normal'">
        </div>

        <div class="hero-text">
            HAL EVENT PROJECT
        </div>

        <a href="index.html" class="enter-btn interactable">
            Explore VIB
        </a>

        <div class="mt-4 text-[10px] font-bold tracking-[0.5em] opacity-60">
            HAL TOKYO 25
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const vBar = document.getElementById('v-bar');
            const counter = document.querySelector('.loader-counter');
            const wrapper = document.getElementById('loader-wrapper');
            const hero = document.getElementById('hero');
            const logo = document.getElementById('main-logo');
            const text = document.querySelector('.hero-text');

            // 模拟资源加载逻辑
            let progress = 0;
            
            // 确保图片加载完毕后再结束 Loading (防止图片没出来就开门)
            let isImageLoaded = false;
            if(logo.complete) {
                isImageLoaded = true;
            } else {
                logo.onload = () => { isImageLoaded = true; };
                logo.onerror = () => { isImageLoaded = true; }; // 即使失败也允许进入
            }

            const updateLoader = () => {
                // 随机增加进度
                progress += Math.random() * 5 + 1; // 稍微平滑一点
                
                // 如果进度到了90%但图片还没好，就卡在90%
                if (progress > 90 && !isImageLoaded) {
                    progress = 90;
                }
                if (progress >= 100) progress = 100;

                // 使用 transform scaleY 替代 height，性能更好
                vBar.style.transform = `scaleY(${progress / 100})`;
                counter.innerText = Math.floor(progress) + '%';

                if (progress < 100) {
                    requestAnimationFrame(updateLoader);
                } else {
                    // 完成
                    setTimeout(() => {
                        vBar.classList.add('fade-out');
                        counter.classList.add('fade-out');
                        wrapper.classList.add('split-open');
                        
                        setTimeout(() => {
                            hero.style.opacity = '1';
                            hero.style.transform = 'scale(1)';
                            if(logo) logo.classList.add('logo-reveal');
                            if(text) text.classList.add('show');
                        }, 500);
                    }, 300);
                }
            };

            requestAnimationFrame(updateLoader);
        });

        // --- 优化的光标与磁力效果 ---
        
        // 检测是否支持触摸，如果是触摸屏，不运行复杂的光标逻辑
        const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);

        if (!isTouchDevice) {
            const cursorDot = document.querySelector('.cursor-dot');
            const cursorOutline = document.querySelector('.cursor-outline');
            const magneticWrap = document.querySelector('.magnetic-wrap');

            let mouseX = 0, mouseY = 0;
            let outlineX = 0, outlineY = 0;

            // 使用 requestAnimationFrame 优化光标跟随，更平滑
            const animateCursor = () => {
                // 简单的线性插值 (Lerp) 增加拖尾感
                const dt = 0.15; // 延迟系数
                outlineX += (mouseX - outlineX) * dt;
                outlineY += (mouseY - outlineY) * dt;

                cursorDot.style.transform = `translate(${mouseX}px, ${mouseY}px) translate(-50%, -50%)`;
                cursorOutline.style.transform = `translate(${outlineX}px, ${outlineY}px) translate(-50%, -50%)`;

                requestAnimationFrame(animateCursor);
            };
            
            window.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                
                // 磁力效果计算 (限制在 Logo 区域附近)
                // 这里为了性能，仅当鼠标在页面中心区域时计算
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                
                // 简单的距离衰减逻辑
                const x = (centerX - e.clientX) / 30;
                const y = (centerY - e.clientY) / 30;
                
                // 只有当鼠标在页面中间区域活动时才大幅度移动 Logo
                magneticWrap.style.transform = `translate(${x}px, ${y}px)`;
            });

            // 启动动画循环
            requestAnimationFrame(animateCursor);

            // 交互状态监听
            document.querySelectorAll('.interactable').forEach(el => {
                el.addEventListener('mouseenter', () => document.body.classList.add('hover-active'));
                el.addEventListener('mouseleave', () => document.body.classList.remove('hover-active'));
            });
        }
    </script>
</body>
</html>