<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="HAL未来創造展欢迎页面 - Welcome to HAL Future Creation Exhibition">
    <title>Welcome | HAL未来創造展</title>
    
    <!-- フォントプリロード -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Space+Grotesk:wght@300;500;700&family=Noto+Sans+JP:wght@900&display=swap" rel="stylesheet">
    
    <!-- 外部CSSファイル -->
    <link rel="stylesheet" href="./css/sections/welcome.css">
    
    <!-- インライン重要CSS（初回描画最適化） -->
    <style>
        /* クリティカルパスCSS - FOUC防止 */
        body {
            background-color: #fce412;
            color: #1a1a1a;
            font-family: 'Space Grotesk', sans-serif;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }
        
        /* 読み込み時にコンテンツを非表示 */
        .welcome-hero {
            opacity: 0;
        }
        .brand-logo {
            width: 300px; max-width: 60vw; mix-blend-mode: multiply; 
            filter: blur(10px); 
            transform: translateY(20px) translateZ(0);
            transition: all 1.5s cubic-bezier(0.19, 1, 0.22, 1);
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            will-change: filter, transform;
        }
        .logo-reveal { 
            filter: blur(0px) !important; 
            transform: translateY(0) translateZ(0) !important; 
        }
        .hero-text {
            margin-top: 2rem; text-transform: uppercase; letter-spacing: 0.2em;
            font-size: 0.8rem; opacity: 0; transform: translateY(20px);
            transition: opacity 0.8s ease 0.5s, transform 0.8s ease 0.5s;
        }
        .hero-text.show { opacity: 1; transform: translateY(0); }
        
        /* JS無効時にコンテンツを表示 */
        .no-js .welcome-hero {
            opacity: 1;
        }
    </style>
</head>
<body class="welcome-page">
    <!-- ローダー層 -->
    <div id="welcome-loader-wrapper" class="welcome-loader-wrapper" role="progressbar" aria-label="ページ読み込み中" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
        <div id="welcome-panel-left" class="welcome-loader-panel welcome-panel-left" aria-hidden="true"></div>
        <div id="welcome-panel-right" class="welcome-loader-panel welcome-panel-right" aria-hidden="true"></div>
        <div class="welcome-loading-line-wrap" aria-hidden="true">
            <div id="welcome-v-bar" class="welcome-v-bar"></div>
        </div>
        <div class="welcome-loader-counter" aria-live="polite" aria-atomic="true">0%</div>
    </div>

    <!-- カスタムカーソル（デスクトップのみ） -->
    <div class="welcome-cursor-dot" aria-hidden="true"></div>
    <div class="welcome-cursor-outline" aria-hidden="true"></div>
    
    <!-- アニメーション背景 -->
    <div class="welcome-animated-bg" aria-hidden="true"></div>
    
    <!-- パーティクル効果 -->
    <div class="welcome-particles" aria-hidden="true"></div>
    
    <!-- 背景グリッド -->
    <div class="welcome-grid-bg" aria-hidden="true"></div>
    
    <!-- グロー効果 -->
    <div class="welcome-glow" aria-hidden="true"></div>

    <!-- マーキー -->
    <div class="welcome-marquee-container" aria-hidden="true">
        <div class="welcome-marquee-content">
            HAL FUTURE CREATION EXHIBITION 2025  //  DESIGN  //  DEVELOPMENT  //  INNOVATION  //  HAL FUTURE CREATION EXHIBITION 2025  //  DESIGN  //  DEVELOPMENT  //  INNOVATION  //
        </div>
    </div>

        <div id="hero">
        <div class="magnetic-wrap">
            <img src="./assets/icons/vib_black.png" alt="Logo" class="brand-logo" id="main-logo" width="300" height="300" style="image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;">
        </div>

        <h1 class="welcome-hero-text">
            HAL EVENT PROJECT
        </h1>

        <a 
            href="index.html" 
            class="welcome-enter-btn welcome-interactable"
            aria-label="VIBメインページへ"
        >
            Explore VIB
        </a>

        <div class="welcome-date" style="font-family: 'Space Grotesk', sans-serif;"></div>
        
        <div class="welcome-tokyo-text" style="font-family: 'Space Grotesk', sans-serif;">
            HAL TOKYO 25
        </div>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const vBar = document.getElementById('welcome-v-bar');
            const counter = document.querySelector('.welcome-loader-counter');
            const wrapper = document.getElementById('welcome-loader-wrapper');
            const hero = document.getElementById('hero');
            const logo = document.getElementById('main-logo');
            const text = document.querySelector('.welcome-hero-text');

            // 确保 logo 最终会清晰显示（备用方案）
            const ensureLogoClear = () => {
                if(logo && !logo.classList.contains('logo-reveal')) {
                    logo.classList.add('logo-reveal');
                }
            };

            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.floor(Math.random() * 5) + 2;
                if (progress > 100) progress = 100;
                
                if (vBar) vBar.style.height = progress + '%';
                if (counter) counter.innerText = progress + '%';

                if (progress === 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        if (vBar) vBar.classList.add('fade-out');
                        if (counter) counter.classList.add('fade-out');
                        if (wrapper) wrapper.classList.add('split-open');
                        
                        setTimeout(() => {
                            if (hero) {
                                hero.style.opacity = '1';
                                hero.style.transform = 'scale(1)';
                            }
                            if(logo) {
                                logo.classList.add('logo-reveal');
                                // 强制移除模糊（备用方案）
                                logo.style.filter = 'blur(0px)';
                                logo.style.transform = 'translateY(0) translateZ(0)';
                            }
                            if(text) text.classList.add('show');
                        }, 500);
                    }, 500);
                }
            }, 30);

            // 备用方案：如果 3 秒后 logo 还是模糊，强制清除
            setTimeout(ensureLogoClear, 3000);
        });

        // 鼠标跟随
        const cursorDot = document.querySelector('.welcome-cursor-dot');
        const cursorOutline = document.querySelector('.welcome-cursor-outline');
        window.addEventListener('mousemove', (e) => {
            if (!cursorDot || !cursorOutline) return;
            const posX = e.clientX;
            const posY = e.clientY;
            cursorDot.style.left = `${posX}px`;
            cursorDot.style.top = `${posY}px`;
            cursorOutline.animate({
                left: `${posX}px`,
                top: `${posY}px`
            }, { duration: 500, fill: "forwards" });
        });

        // 交互
        document.querySelectorAll('.welcome-interactable').forEach(el => {
            el.addEventListener('mouseenter', () => document.body.classList.add('hover-active'));
            el.addEventListener('mouseleave', () => document.body.classList.remove('hover-active'));
        });

        // 磁力
        const magneticWrap = document.querySelector('.magnetic-wrap');
        document.addEventListener('mousemove', (e) => {
            const x = (window.innerWidth / 2 - e.clientX) / 25;
            const y = (window.innerHeight / 2 - e.clientY) / 25;
            magneticWrap.style.transform = `translate(${x}px, ${y}px)`;
        });
    </script>
</body>
</html>
